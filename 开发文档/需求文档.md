# 需求文档

## 基本需求描述

### 需求概述

实现一个自动生成小学四则运算题目的命令行程序，该程序要求能根据设定的参数生成一定数量的题目，自动生成题目对应的答案，要求题目不能重复，且需要符合规定的条件，并进题目以及答案分别存进指定文件中。

另外，实现一个答案校对程序，能对指定题目文件以及答案文件，计算答案的准确率，并将成绩保存在指定文件中。

### 具体需求文档

**生成题目格式**

生成题目可包含的符号：

- 自然数：0, 1, 2, …。
- 真分数：1/2, 1/3, 2/3, 1/4, 1’1/2, …。
- 运算符：+, −, ×, ÷。
- 括号：(, )。
- 等号：=。
- 分隔符：空格（用于四则运算符和等号前后）。

算术表达式：
$$
e = n | e_1 + e_2 | e_1 − e_2 | e_1 \times e_2 | e1 \div e2 | (e),
$$
其中$e$, $e_1$和$e_2$为表达式，$n$为自然数或真分数。

**命令行参数**

1. 使用 -n 参数控制生成题目的个数，例如

   ```bash
   Myapp.exe -n 10
   ```

   将生成10个题目。

2. 使用 -r 参数控制题目中数值（自然数、真分数和真分数分母）的范围，例如

   ```bash
   Myapp.exe -n 10
   ```

   将生成10以内（不包括10）的四则运算题目。该参数可以设置为1或其他自然数。该参数必须给定，否则程序报错并给出帮助信息。

3. 程序支持对给定的题目文件和答案文件，判定答案中的对错并进行数量统计，输入参数如下：

   ```bash
   Myapp.exe -e <exercisefile>.txt -a <answerfile>.txt
   ```

**文件存储**

1. 生成的题目存入执行程序的当前目录下的Exercises.txt文件，格式如下：

   > 1. 四则运算题目1
   > 2. 四则运算题目2
   >
   > ……

    其中真分数在输入输出时采用如下格式，真分数五分之三表示为3/5，真分数二又八分之三表示为2’3/8。

2. 在生成题目的同时，计算出所有题目的答案，并存入执行程序的当前目录下的Answers.txt文件，格式如下：

   > 1. 答案1
   > 2. 答案2
   >
   > ……

   特别的，真分数的运算如下例所示：1/6 + 1/8 = 7/24。

3. 在判定答案对错并进行数量统计后，统计结果输出到文件Grade.txt，格式如下：

   > Correct: 5 (1, 3, 5, 7, 9)
   >
   > Wrong: 5 (2, 4, 6, 8, 10)

   其中“:”后面的数字5表示对/错的题目的数量，括号内的是对/错题目的编号。为简单起见，假设输入的题目都是按照顺序编号的符合规范的题目。

**生成题目要求**

1. 生成的题目中计算过程不能产生负数，也就是说算术表达式中如果存在形如$e_1− e_2$的子表达式，那么$e_1≥ e_2$。
2. 生成的题目中如果存在形如$e_1\div e_2$的子表达式，那么**其结果应是真分数**。
3. **每道题目中出现的运算符个数不超过3个。**
4. 程序一次运行生成的题目不能重复，**即任何两道题目不能通过有限次交换+和×左右的算术表达式变换为同一道题目**。例如，23 + 45 = 和45 + 23 = 是重复的题目，6 × 8 = 和8 × 6 = 也是重复的题目。**3+(2+1)和1+2+3这两个题目是重复的，由于+是左结合的，1+2+3等价于(1+2)+3，也就是3+(1+2)，也就是3+(2+1)。但是1+2+3和3+2+1是不重复的两道题，因为1+2+3等价于(1+2)+3，而3+2+1等价于(3+2)+1，它们之间不能通过有限次交换变成同一个题目。**

## 功能设计

### 参数获取功能

该功能主要用于获取一些生成题目以及存储文件时必要的参数，该项目有两种实现方式：

- 通过命令行获取参数，如下：

  ```bash
  # 获取生成题目数量的参数
  Myapp.exe -n 10
  
  # 获取生成题目范围的参数
  Myapp.exe -r 10
  
  # 答案判别的参数
  Myapp.exe -e <exercisefile>.txt -a <answerfile>.txt
  ```

- 通过 web 网站的图形界面获取参数

### 文件存取功能

该功能主要用于将题目、答案或成绩存进指定文件中，主要实现以下几个功能点：

- 题目文件或答案文件的读取，读取指定的文件信息，并生成一个列表
- 题目文件或答案文件的存储，读取指定的文件信息以及列表，并将结果存进指定文件中
- 成绩信息的存储，将用户的答案判定结果按要求格式存进指定文件中

### 答案计算与查错功能

该功能主要包括两个功能点：

- 采用逆波兰计算器对给定的式子进行计算，即实现将算式转换为逆波兰式，并实现逆波兰计算
- 将结果与给定答案进行比对，以实现答案判定。

### 题目生成功能

该功能主要实现符合需求的题目的生成，主要功能点如下：

- 随机生成符合数学规律的算式
- 对生成的数学式，进行查重功能，并剔除重复算式
- 判定数学式是否符合题目要求，并选取出其中符合要求的题目：
  - 出现的数字在限定的数字范围内
  - 生成的题目中计算过程不能产生负数，也就是说算术表达式中如果存在形如$e_1− e_2$的子表达式，那么$e_1≥ e_2$。
  - 生成的题目中如果存在形如$e_1\div e_2$的子表达式，那么其结果应是真分数。

